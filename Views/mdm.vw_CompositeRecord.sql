SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
CREATE VIEW [mdm].[vw_CompositeRecord]
AS

SELECT dc.DimCustomerId ,
       dc.BatchId ,
       dc.ODSRowLastUpdated ,
       dc.SourceDB ,
       dc.SourceSystem ,
       dc.SourceSystemPriority ,
       dc.SSID ,
       dc.CustomerType ,
       dc.CustomerStatus ,
       dc.customer_matchkey ,
       dc.matchkey_updatedate ,
       dc.AccountId ,
       dc.AccountType ,
       dc.AccountRep ,
       dc.CompanyName ,
       dc.SalutationName ,
       dc.DonorMailName ,
       dc.DonorFormalName ,
       dc.Birthday ,
       dc.Gender ,
       dc.CD_Gender ,
       dc.MergedRecordFlag ,
       dc.MergedIntoSSID ,
       dc.IsBusiness ,
       dc.contactattrDirtyHash ,
       dc.Prefix ,
       dc.FirstName ,
       dc.MiddleName ,
       dc.LastName ,
       dc.Suffix ,
       dc.FullName ,
       dc.NameDirtyHash ,
       dc.NameIsCleanStatus ,
       dc.NameMasterId ,
       dc.AddressPrimaryStreet ,
       dc.AddressPrimarySuite ,
       dc.AddressPrimaryCity ,
       dc.AddressPrimaryState ,
       dc.AddressPrimaryZip ,
       dc.AddressPrimaryPlus4 ,
       dc.AddressPrimaryCounty ,
       dc.AddressPrimaryCountry ,
       dc.AddressPrimaryLatitude ,
       dc.AddressPrimaryLongitude ,
       dc.AddressPrimaryDirtyHash ,
       dc.AddressPrimaryIsCleanStatus ,
       dc.AddressPrimaryNCOAStatus ,
       dc.AddressPrimaryMasterId ,
       dc.ContactDirtyHash ,
       dc.ContactGUID ,
       dc.AddressOneStreet ,
       dc.AddressOneSuite ,
       dc.AddressOneCity ,
       dc.AddressOneState ,
       dc.AddressOneZip ,
       dc.AddressOnePlus4 ,
       dc.AddressOneCounty ,
       dc.AddressOneCountry ,
       dc.AddressOneLatitude ,
       dc.AddressOneLongitude ,
       dc.AddressOneDirtyHash ,
       dc.AddressOneIsCleanStatus ,
       dc.AddressOneStreetNCOAStatus ,
       dc.AddressOneMasterId ,
       dc.AddressTwoStreet ,
       dc.AddressTwoSuite ,
       dc.AddressTwoCity ,
       dc.AddressTwoState ,
       dc.AddressTwoZip ,
       dc.AddressTwoPlus4 ,
       dc.AddressTwoCounty ,
       dc.AddressTwoCountry ,
       dc.AddressTwoLatitude ,
       dc.AddressTwoLongitude ,
       dc.AddressTwoDirtyHash ,
       dc.AddressTwoIsCleanStatus ,
       dc.AddressTwoStreetNCOAStatus ,
       dc.AddressTwoMasterId ,
       dc.AddressThreeStreet ,
       dc.AddressThreeSuite ,
       dc.AddressThreeCity ,
       dc.AddressThreeState ,
       dc.AddressThreeZip ,
       dc.AddressThreePlus4 ,
       dc.AddressThreeCounty ,
       dc.AddressThreeCountry ,
       dc.AddressThreeLatitude ,
       dc.AddressThreeLongitude ,
       dc.AddressThreeDirtyHash ,
       dc.AddressThreeIsCleanStatus ,
       dc.AddressThreeStreetNCOAStatus ,
       dc.AddressThreeMasterId ,
       dc.AddressFourStreet ,
       dc.AddressFourSuite ,
       dc.AddressFourCity ,
       dc.AddressFourState ,
       dc.AddressFourZip ,
       dc.AddressFourPlus4 ,
       dc.AddressFourCounty ,
       dc.AddressFourCountry ,
       dc.AddressFourLatitude ,
       dc.AddressFourLongitude ,
       dc.AddressFourDirtyHash ,
       dc.AddressFourIsCleanStatus ,
       dc.AddressFourStreetNCOAStatus ,
       dc.AddressFourMasterId ,
       dc.PhonePrimary ,
       dc.PhonePrimaryDNC ,
       dc.PhonePrimaryDirtyHash ,
       dc.PhonePrimaryIsCleanStatus ,
       dc.PhonePrimaryMasterId ,
       dc.PhoneHome ,
       dc.PhoneHomeDNC ,
       dc.PhoneHomeDirtyHash ,
       dc.PhoneHomeIsCleanStatus ,
       dc.PhoneHomeMasterId ,
       dc.PhoneCell ,
       dc.PhoneCellDNC ,
       dc.PhoneCellDirtyHash ,
       dc.PhoneCellIsCleanStatus ,
       dc.PhoneCellMasterId ,
       dc.PhoneBusiness ,
       dc.PhoneBusinessDNC ,
       dc.PhoneBusinessDirtyHash ,
       dc.PhoneBusinessIsCleanStatus ,
       dc.PhoneBusinessMasterId ,
       dc.PhoneFax ,
       dc.PhoneFaxDNC ,
       dc.PhoneFaxDirtyHash ,
       dc.PhoneFaxIsCleanStatus ,
       dc.PhoneFaxMasterId ,
       dc.PhoneOther ,
       dc.PhoneOtherDNC ,
       dc.PhoneOtherDirtyHash ,
       dc.PhoneOtherIsCleanStatus ,
       dc.PhoneOtherMasterId ,
       dc.EmailPrimary ,
       dc.EmailPrimaryDirtyHash ,
       dc.EmailPrimaryIsCleanStatus ,
       dc.EmailPrimaryMasterId ,
       dc.EmailOne ,
       dc.EmailOneDirtyHash ,
       dc.EmailOneIsCleanStatus ,
       dc.EmailOneMasterId ,
       dc.EmailTwo ,
       dc.EmailTwoDirtyHash ,
       dc.EmailTwoIsCleanStatus ,
       dc.EmailTwoMasterId ,
       dc.ExtAttribute1 ,
       dc.ExtAttribute2 ,
       dc.ExtAttribute3 ,
       dc.ExtAttribute4 ,
       dc.ExtAttribute5 ,
       dc.ExtAttribute6 ,
       dc.ExtAttribute7 ,
       dc.ExtAttribute8 ,
       dc.ExtAttribute9 ,
       dc.ExtAttribute10 ,
       dc.extattr1_10DirtyHash ,
       dc.ExtAttribute11 ,
       dc.ExtAttribute12 ,
       dc.ExtAttribute13 ,
       dc.ExtAttribute14 ,
       dc.ExtAttribute15 ,
       dc.ExtAttribute16 ,
       dc.ExtAttribute17 ,
       dc.ExtAttribute18 ,
       dc.ExtAttribute19 ,
       dc.ExtAttribute20 ,
       dc.extattr11_20DirtyHash ,
       dc.ExtAttribute21 ,
       dc.ExtAttribute22 ,
       dc.ExtAttribute23 ,
       dc.ExtAttribute24 ,
       dc.ExtAttribute25 ,
       dc.ExtAttribute26 ,
       dc.ExtAttribute27 ,
       dc.ExtAttribute28 ,
       dc.ExtAttribute29 ,
       dc.ExtAttribute30 ,
       dc.extattr21_30DirtyHash ,
       dc.ExtAttribute31 ,
       dc.ExtAttribute32 ,
       dc.ExtAttribute33 ,
       dc.ExtAttribute34 ,
       dc.ExtAttribute35 ,
       dc.extattr31_35DirtyHash ,
       dc.SSCreatedBy ,
       dc.SSUpdatedBy ,
       dc.SSCreatedDate ,
       dc.SSUpdatedDate ,
       dc.CreatedBy ,
       dc.UpdatedBy ,
       dc.CreatedDate ,
       dc.UpdatedDate ,
       dc.IsDeleted ,
       dc.DeleteDate ,
       dc.FuzzyNameGUID
	   , ssbid.SSB_CRMSYSTEM_CONTACT_ID
	   , ssbid.SSB_CRMSYSTEM_ACCT_ID ,
		ssbid.SSB_CRMSYSTEM_PRIMARY_FLAG ,
		ssbid.SSB_CRMSYSTEM_ACCT_PRIMARY_FLAG ,
		ssbid.SSB_CRMSYSTEM_HOUSEHOLD_ID ,
		ssbid.SSB_CRMSYSTEM_HOUSEHOLD_PRIMARY_FLAG ,
		ssbid.ssb_crmsystem_contactacct_id
FROM dbo.dimcustomerssbid ssbid (NOLOCK)
JOIN dbo.DimCustomer dc (NOLOCK) ON ssbid.DimCustomerId = dc.DimCustomerId
WHERE ssbid.SSB_CRMSYSTEM_PRIMARY_FLAG = 1

GO
